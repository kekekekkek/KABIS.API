<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="description" content="Руководство по работе с KABIS.API">
        <meta name="keywords" content="кабис, КАБИС, ЭБС КАБИС, КАБИС.API, КАБИС API, KABIS.API, KABIS API">
        <link rel="icon" href="kapi32.png" type="image/png">
        <title>kapi32 - Руководство для разработчиков</title>
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <div class="block">
            <div class="block">
                <p class="text-header"><b><a name="Introduction">Введение</a></b></p>
                <hr class="horizontal-line-bold">
                <p class="text" style="font-size: 18px; margin-left: 5%;">
                    Данный модуль / библиотека (<b>.dll</b>) позволит Вам взаимодействовать с базой данных <a href="https://kabis.kz/kabis.htm" target="_blank">КАБИС</a>
                    напрямую, при помощи функций экспорта, без использования графической обёртки, на которую помимо этого наложено множество ограничений.
                    <br><br>
                    На официальном <a href="https://kabis.kz/kabis2.htm" target="_blank">сайте</a> разработчика есть упоминание
                    про <b>API</b>, но более подробную информацию по этому поводу, кроме пункта с описанием этой возможности, мне найти не удалось :(
                    <br><br>
                    Но, так как эта возможность даёт выполнять ряд определённых задач с базой данных библиотеки, Вы и можете наблюдать решение данной проблемы
                    в виде модуля, где имеются все необходимые функции экспорта для манипуляции данными в базе данных.
                    <br><br>
                    База данных работает при помощи драйвера <a href="https://ru.wikipedia.org/wiki/ODBC" target="_blank">ODBC</a>, поэтому решение данной проблемы не заставило себя долго ждать.
                    Так как я не смог открыть файл базы данных при помощи <b>MS Access</b> и других программ управления базами данных, этот драйвер оставался единственной надеждой.
                    <br><br>
                    В будущем планируется доработка модуля и последующее добавление новых функций для более гибкого взаимодействия с базой данных библиотеки.
                    <br><br>
                    Версия документации: <b>0.1</b><br>
                    Версия библиотек (модулей): <b>0.1</b><br>
                    <br><b>P.S:</b> Модуль <i>kapi32u (utils).dll</i> необходим для выполнения специфических задач, таких как получение пароля от БД из памяти программы. 
                    Возможно это можно сделать каким-то иным путём, но пока я нашёл только это решение данной проблемы.
                </p>
                <div style="margin-bottom: 40px;"></div>
            </div>
            <div class="block">
                <p class="text-header"><b><a name="Start">Начало работы с библиотеками <i>kapi32.dll</i> и <i>kapi32u.dll</i></b></a></p>
                <hr class="horizontal-line-bold">
                <p class="text" style="font-size: 18px; margin-left: 5%;">Все необходимые функции экспорта библиотек и их описание расположены в документации ниже.</p>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    <u>Функции экспорта <b><i>kapi32.dll</i></b>:</u>
                    <ul style="margin-left: 5%; margin-right: 5%;">
                        <li><a href="#PtrToStr">PtrToStr</a> - Преобразовывает указатель на массив из символов в текст;</li>
                        <li><a href="#OpenDataBase">OpenDataBase</a> - Открывает локальную базу данных для последующего выполнения к ней запросов;</li>
                        <li><a href="#EnumTables">EnumTables</a> - Позволяет перечислить все имеющиеся таблицы в базе данных. Всегда должна выполняться после вызова <b><i>OpenDataBase</i></b>;</li>
                        <li><a href="#GetTableCount">GetTableCount</a> - Получает текущее количество таблиц в базе данных. Всегда должна выполняться после вызова <b><i>OpenDataBase</i></b>;</li>
                        <li><a href="#EnumFields">EnumFields</a> - Позволяет перечислить и получить имена всех полей, которые находятся в таблице, указанной в аргументе функции. Всегда должна выполняться после вызова <b><i>OpenDataBase</i></b>;</li>
                        <li><a href="#GetFieldCount">GetFieldCount</a> - Позволяет получить количество полей в таблице, указанной в аргументе функции. Всегда должна выполняться после вызова <b><i>OpenDataBase</i></b>;</li>
                        <li><a href="#SelectAllFrom">SelectAllFrom</a> - Извлекает все данные таблицы вместе с полями через запрос "<i>SELECT * FROM `TableName`;</i>". Всегда должна выполняться после вызова <b><i>OpenDataBase</i></b>;</li>
                        <li><a href="#UnloadTable">UnloadTable</a> - Позволяет выгрузить все записи таблицы вместе с полями в какой-либо файл с определёнными разделителями. Всегда должна выполняться после вызова <b><i>OpenDataBase</i></b>;</li>
                        <li><a href="#GetTableRecords">GetTableRecords</a> - Получает количество записей в таблице, указанной в аргументе функции. Всегда должна выполняться после вызова <b><i>OpenDataBase</i></b>;</li>
                        <li><a href="#CloseDataBase">CloseDataBase</a> - Закрывает соединение с базой данных. Должна вызываться после завершения работы с базой данных.</li>
                    </ul>
                </p>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    <u>Функции экспорта <b><i>kapi32u.dll</i></b>:</u>
                    <ul style="margin-left: 5%; margin-right: 5%;">
                        <li><a href="#ScanForPass">ScanForPass</a> - Извлекает из памяти процесса (<b>программы</b>) пароль для базы данных. 
                            <br><br>
                            Так как данные о пароле не хранятся в реестре или в файловой системе компьютера, Вам необходимо будет вызывать эту функцию и результат её
                            выполнения передавать во второй аргумент функции <b><i>OpenDataBase</i></b> для корректного установления соединения с базой данных.
                        </li>
                    </ul>
                </p>

                <p class="text" style="font-size: 22px;"><b>Заглавия</b></p>
                <hr class="horizontal-line">
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    <ul style="margin-left: 5%; margin-right: 5%;">
                        <li><a href="#Introduction">Введение</a> - Заглавие с вводной частью;</li>
                        <li><a href="#Start">Начало работы</a> - Заглавие с описанием библиотек и их функций;</li>
                        <li><a href="#Conclusion">Заключение</a> - Заглавие с заключением.</li>
                    </ul>
                </p>

                <p class="text" style="font-size: 22px;"><b>Разделы</b></p>
                <hr class="horizontal-line">
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    <ul style="margin-left: 5%; margin-right: 5%;">
                        <li><a href="#kapi32.dll">Работа с kapi32.dll</a> - Раздел с описанием и примерами работы с библиотекой <b><i>kapi32.dll</i></b>;</li>
                        <li><a href="#kapi32u.dll">Работа с kapi32u.dll</a> - Раздел с описанием и примерами работы с библиотекой <b><i>kapi32u.dll</i></b>.</li>
                    </ul>
                </p>

                <hr class="horizontal-line-bold">
                <p class="text" style="font-size: 32px;"><a name="kapi32.dll">[+] Работа с kapi32.dll</a></p>

                <!-- Начало 1 -->
                <p class="text" style="font-size: 22px;"><b><a name="PtrToStr"></a>PtrToStr</b></p>
                <hr class="horizontal-line">
                <div class="code-section">
                    <p class="text">
                        <span class="keyword-type">string</span> PtrToStr(<span class="keyword-arg">IntPtr</span> intPtr);
                    </p>
                </div>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Преобразовывает указатель на массив из символов в текст.
                    <br>
                    Возвращаемый результат:
                    <ul style="margin-left: 5%;">
                        <li>Функция преобразовывает указатель и в качестве результата возвращает строку. Проверить возвращаемый результат (длину строки) можно при помощи свойства <b><i>.Length</i></b>
                        или метода <b><i>string.IsNullOrEmpty</i></b>.</li>
                    </ul>
                </p>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Аргументы:
                    <ol style="margin-left: 5%;">
                        <li ><b style="background-color: rgb(215, 215, 215);">[in] intPtr</b> - Указатель на массив символов. Обычно используется только для преобразования результата возврата функции <b><i>ScanForPass</i></b>, для получения строки (пароля от базы данных).</li>
                    </ol>
                </p>

                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример импорта
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 80%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p>
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
[<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
<span class="keyword-type">extern public static string</span> PtrToStr(<span class="keyword-arg">IntPtr</span> intPtr);
</pre>
                    </p>
                </div>

                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример кода
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 83.2%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
<span class="keyword-blue">using</span> System;
<span class="keyword-blue">using</span> System.Text;
<span class="keyword-blue">using</span> System.Runtime.InteropServices;

<span class="keyword-blue">namespace</span> KabisAPITest
{
    <span class="keyword-blue">internal class</span> Program
    {
        <span class="keyword-comment">//Импортировать функции необходимо именно так, как показано в примере, указывая согласование о вызове</span>

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32u.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static <span class="keyword-arg">IntPtr</span></span> ScanForPass(<span class="keyword-arg">string</span> strAppName);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> PtrToStr(<span class="keyword-arg">IntPtr</span> intPtr);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> OpenDataBase(<span class="keyword-arg">string</span> strDataBase, <span class="keyword-arg">string</span> strPassword);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> CloseDataBase();

        <span class="keyword-blue">static void</span> Main(<span class="keyword-arg">string[]</span> args)
        {
            <span class="keyword-class">Console</span>.InputEncoding = Encoding.<span class="keyword-class">UTF8</span>;
            <span class="keyword-class">Console</span>.OutputEncoding = Encoding.<span class="keyword-class">UTF8</span>;

            <span class="keyword-comment">//Присвоение строковой переменной результата выполнения функции PtrToStr</span>
            <span class="keyword-blue">string</span> strDBPassword = PtrToStr(ScanForPass(<span class="keyword-arg">"C:\\KABIS\\KABIS.EXE"</span>));

            <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Пароль от базы данных: {0}"</span>, strDBPassword);
            <span class="keyword-class">Console</span>.ReadKey();
        }
    }
}</pre>
                    </p>
                </div>
                <!-- Конец 1 -->

                <!-- Начало 2 -->
                <p class="text" style="font-size: 22px;"><b><a name="OpenDataBase"></a>OpenDataBase</b></p>
                <hr class="horizontal-line">
                <div class="code-section">
                    <p class="text">
                        <span class="keyword-type">bool</span> OpenDataBase(<span class="keyword-arg">string</span> strDataBase, <span class="keyword-arg">string</span> strPassword);
                    </p>
                </div>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Позволяет установить соединение с локальной базой данных.
                    <br>
                    Возвращаемый результат:
                    <ul style="margin-left: 5%;">
                        <li>В случае успеха, функция возвращает результат <b class="keyword-blue">true</b> (1);</li>
                        <li>В случае неудачи, возвращаемый результат будет равен <b class="keyword-blue">false</b> (0).</li>
                    </ul>
                </p>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Аргументы:
                    <ol style="margin-left: 5%;">
                        <li ><b style="background-color: rgb(215, 215, 215);">[in] strDataBase</b> - Путь до Вашей локальной базы данных. Для примера: <i><b>C:\\KABIS\\Data\\Books.dbx</b></i>;</li>
                        <li><b style="background-color: rgb(215, 215, 215);">[in] strPassword</b> - Пароль для авторизации в базе данных. 
                            Извлекается путём вызова функции <b><i>ScanForPass</i></b> из библиотеки <i>kapi32u.dll</i>.
                        </li>
                    </ol>
                </p>

                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример импорта
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 80%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
[<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
<span class="keyword-type">extern public static bool</span> OpenDataBase(<span class="keyword-arg">string</span> strDataBase, <span class="keyword-arg">string</span> strPassword);
</pre>
                    </p>
                </div>

                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример кода
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 83.2%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
<span class="keyword-blue">using</span> System;
<span class="keyword-blue">using</span> System.Text;
<span class="keyword-blue">using</span> System.Runtime.InteropServices;

<span class="keyword-blue">namespace</span> KabisAPITest
{
    <span class="keyword-blue">internal class</span> Program
    {
        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32u.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static <span class="keyword-arg">IntPtr</span></span> ScanForPass(<span class="keyword-arg">string</span> strAppName);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> PtrToStr(<span class="keyword-arg">IntPtr</span> intPtr);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> OpenDataBase(<span class="keyword-arg">string</span> strDataBase, <span class="keyword-arg">string</span> strPassword);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> CloseDataBase();

        <span class="keyword-blue">static void</span> Main(<span class="keyword-arg">string[]</span> args)
        {
            <span class="keyword-class">Console</span>.InputEncoding = Encoding.<span class="keyword-class">UTF8</span>;
            <span class="keyword-class">Console</span>.OutputEncoding = Encoding.<span class="keyword-class">UTF8</span>;

            <span class="keyword-blue">if</span> (OpenDataBase(<span class="keyword-arg">"C:\\KABIS\\Data\\Books.dbx"</span>, PtrToStr(ScanForPass(<span class="keyword-arg">"C:\\KABIS\\KABIS.EXE"</span>))))
            {
                <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"База данных была успешно открыта!"</span>);

                <span class="keyword-comment">//Здесь можно выполнить какой-либо код перед закрытием базы данных...</span>

                <span class="keyword-blue">if</span> (CloseDataBase())
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Соединение с базой данных было закрыто."</span>);
            }

            <span class="keyword-class">Console</span>.ReadKey();
        }
    }
}</pre>
                    </p>
                </div>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 25px;">
                    <big><b>ДОПОЛНИТЕЛЬНО</b>:</big>
                    <br>
                    Вы можете открывать базу данных, даже если она находится на каком-либо локальном компьютере в сети, либо по <b><i>названию компьютера</i></b>, либо 
                    по его <b><i>IP-адресу</i></b>. Подробную инструкцию о том, как можно реализовать доступ к сетевой папке Вы сможете найти <a href="https://dzen.ru/a/YlfQqXIO2GZemP1I" target="_blank">здесь</a> [клик!]. 
                    <br>
                    <br>
                    Только учтите, если другая база данных на сервере использует другой пароль для авторизации, Вам необходимо будет удалить параметр <b>DBPassword</b> в реестре системы
                    по следующему пути: <b>HKEY_CURRENT_USER\SOFTWARE\kapi32</b>, чтобы функция <b>ScanForPass</b> смогла 
                    его пересоздать. 
                    <br>
                    <br>
                    Более подробно о данной информации можно узнать в описании к функции <b>ScanForPass</b>.
                </p>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример кода
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 83.2%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
<span class="keyword-blue">using</span> System;
<span class="keyword-blue">using</span> System.Text;
<span class="keyword-blue">using</span> System.Runtime.InteropServices;

<span class="keyword-blue">namespace</span> KabisAPITest
{
    <span class="keyword-blue">internal class</span> Program
    {
        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32u.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static <span class="keyword-arg">IntPtr</span></span> ScanForPass(<span class="keyword-arg">string</span> strAppName);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> PtrToStr(<span class="keyword-arg">IntPtr</span> intPtr);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> OpenDataBase(<span class="keyword-arg">string</span> strDataBase, <span class="keyword-arg">string</span> strPassword);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> CloseDataBase();

        <span class="keyword-blue">static void</span> Main(<span class="keyword-arg">string[]</span> args)
        {
            <span class="keyword-class">Console</span>.InputEncoding = Encoding.<span class="keyword-class">UTF8</span>;
            <span class="keyword-class">Console</span>.OutputEncoding = Encoding.<span class="keyword-class">UTF8</span>;

            <span class="keyword-comment">//Открываем базу данных по имени компьютера и пути к сетевой папке.</span>

            <span class="keyword-blue">if</span> (OpenDataBase(<span class="keyword-arg">"\\\\DESKTOP-IQ3MQPS\\KABIS\\Data\\Books.dbx"</span>, PtrToStr(
                ScanForPass(<span class="keyword-arg">"\\\\DESKTOP-IQ3MQPS\\KABIS\\KABIS.EXE"</span>))))
            {
                <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"База данных была успешно открыта через сетевую папку по имени компьютера!"</span>);
                CloseDataBase();
            }

            <span class="keyword-comment">//Открываем базу данных по IP-адресу компьютера и пути к сетевой папке.</span>

            <span class="keyword-blue">if</span> (OpenDataBase(<span class="keyword-arg">"\\\\192.168.100.72\\KABIS\\Data\\Books.dbx"</span>, PtrToStr(
                ScanForPass(<span class="keyword-arg">"\\\\192.168.100.72\\KABIS\\KABIS.EXE"</span>))))
            {
                <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"База данных была успешно открыта через сетевую папку по IP-адресу компьютера!"</span>);
                CloseDataBase();
            }

            <span class="keyword-class">Console</span>.ReadKey();
        }
    }
}</pre>
                    </p>
                </div>
                <!-- Конец 2 -->

                <!-- Начало 3 -->
                <p class="text" style="font-size: 22px; margin-top: 40px;"><b><a name="EnumTables">EnumTables</a></b></p>
                <hr class="horizontal-line">
                <div class="code-section">
                    <p class="text">
                        <span class="keyword-type">string</span> EnumTables();
                    </p>
                </div>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Позволяет перечислить все таблицы, которые находятся в базе данных. Функция возвращает строковый результат в формате <b><i>JSON</i></b>. 
                    Все необходимые наименования таблиц можно спарсить по параметру "<i>Tables</i>" при помощи библиотеки <b><i>Newtonsoft.JSON</i></b> для платформы <b><i>.NET</i></b>.
                    <br>
                    Возвращаемый результат:
                    <ul style="margin-left: 5%;">
                        <li>В случае успеха возвращает строку в формате <b><i>JSON</i></b>, которую затем можно спарсить при помощи описанной выше библиотеки;</li>
                        <li>В случае неудачи возвращает <span class="keyword-blue">null</span>.
                        <br><br>
                        Если функция вернула значение <span class="keyword-blue">null</span>, Вы не 
                        сможете проверить его при помощи свойства <b><i>.Length</i></b>, для этого Вы можете проверить результат возврата через оператор сравнения: 
                    <b><i>!= null</i></b> или метода <b><i>string.IsNullOrEmpty</i></b>.</li>
                    </ul>
                </p>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Аргументы: <b style="background-color: rgb(215, 215, 215);">Функция не принимает аргументов.</b>
                </p>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример импорта
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 80%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
[<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
<span class="keyword-type">extern public static string</span> EnumTables();
</pre>
                    </p>
                </div>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример кода
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 83.2%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
<span class="keyword-blue">using</span> System;
<span class="keyword-blue">using</span> System.Text;
<span class="keyword-blue">using</span> System.Runtime.InteropServices;

<span class="keyword-blue">namespace</span> KabisAPITest
{
    <span class="keyword-blue">internal class</span> Program
    {
        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32u.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static <span class="keyword-arg">IntPtr</span></span> ScanForPass(<span class="keyword-arg">string</span> strAppName);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> PtrToStr(<span class="keyword-arg">IntPtr</span> intPtr);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> OpenDataBase(<span class="keyword-arg">string</span> strDataBase, <span class="keyword-arg">string</span> strPassword);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> EnumTables();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> CloseDataBase();

        <span class="keyword-blue">static void</span> Main(<span class="keyword-arg">string[]</span> args)
        {
            <span class="keyword-class">Console</span>.InputEncoding = Encoding.<span class="keyword-class">UTF8</span>;
            <span class="keyword-class">Console</span>.OutputEncoding = Encoding.<span class="keyword-class">UTF8</span>;

            <span class="keyword-blue">if</span> (OpenDataBase(<span class="keyword-arg">"C:\\KABIS\\Data\\Books.dbx"</span>, PtrToStr(ScanForPass(<span class="keyword-arg">"C:\\KABIS\\KABIS.EXE"</span>))))
            {
                <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"База данных была успешно открыта!"</span>);
                <span class="keyword-blue">string</span> strTables = EnumTables();

                <span class="keyword-blue">if</span> (!<span class="keyword-blue">string</span>.IsNullOrEmpty(strTables))
                {
                    <span class="keyword-class">Console</span>.WriteLine(strTables);
                }
                <span class="keyword-blue">else</span>
                {
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Не удалось получить перечень таблиц из базы данных!"</span>);
                }

                <span class="keyword-blue">if</span> (CloseDataBase())
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Соединение с базой данных было закрыто."</span>);
            }

            <span class="keyword-class">Console</span>.ReadKey();
        }
    }
}</pre>
                    </p>
                </div>
                <!-- Конец 3 -->

                <!-- Начало 4 -->
                <p class="text" style="font-size: 22px; margin-top: 40px;"><b><a name="GetTableCount">GetTableCount</a></b></p>
                <hr class="horizontal-line">
                <div class="code-section">
                    <p class="text">
                        <span class="keyword-type">int</span> GetTableCount();
                    </p>
                </div>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Возвращает число таблиц в базе данных.
                    <br>
                    Возвращаемый результат:
                    <ul style="margin-left: 5%;">
                        <li>В случае успеха возвращает целое неотрицательное число, число таблиц в текущей базе данных;
                            <br>Также, число таблиц Вы можете получить при помощи библиотеки <b><i>Newtonsoft.JSON</i></b>, просто вызвав функцию <b><i>EnumTables</i></b>, 
                            спарсив возвращаемый результат и подсчитав количество ячеек в массиве <i>"Tables"</i>.
                        </li>
                        <br>
                        <li>В случае неудачи возвращает <b>-1</b>.
                    </ul>
                </p>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Аргументы: <b style="background-color: rgb(215, 215, 215);">Функция не принимает аргументов.</b>
                </p>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример импорта
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 80%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
[<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
<span class="keyword-type">extern public static int</span> GetTableCount();
</pre>
                    </p>
                </div>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример кода
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 83.2%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
<span class="keyword-blue">using</span> System;
<span class="keyword-blue">using</span> System.Text;
<span class="keyword-blue">using</span> System.Runtime.InteropServices;

<span class="keyword-blue">namespace</span> KabisAPITest
{
    <span class="keyword-blue">internal class</span> Program
    {
        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32u.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static <span class="keyword-arg">IntPtr</span></span> ScanForPass(<span class="keyword-arg">string</span> strAppName);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> PtrToStr(<span class="keyword-arg">IntPtr</span> intPtr);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> OpenDataBase(<span class="keyword-arg">string</span> strDataBase, <span class="keyword-arg">string</span> strPassword);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> EnumTables();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetTableCount();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> CloseDataBase();

        <span class="keyword-blue">static void</span> Main(<span class="keyword-arg">string[]</span> args)
        {
            <span class="keyword-class">Console</span>.InputEncoding = Encoding.<span class="keyword-class">UTF8</span>;
            <span class="keyword-class">Console</span>.OutputEncoding = Encoding.<span class="keyword-class">UTF8</span>;

            <span class="keyword-blue">if</span> (OpenDataBase(<span class="keyword-arg">"C:\\KABIS\\Data\\Books.dbx"</span>, PtrToStr(ScanForPass(<span class="keyword-arg">"C:\\KABIS\\KABIS.EXE"</span>))))
            {
                <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"База данных была успешно открыта!"</span>);
                <span class="keyword-blue">int</span> iTables = GetTableCount();

                <span class="keyword-blue">if</span> (iTables != -1)
                {
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Число таблиц в текущей базе данных: {0}"</span>, iTables);
                }
                <span class="keyword-blue">else</span>
                {
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Не удалось получить число таблиц в базе данных."</span>);
                }

                <span class="keyword-blue">if</span> (CloseDataBase())
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Соединение с базой данных было закрыто."</span>);
            }

            <span class="keyword-class">Console</span>.ReadKey();
        }
    }
}</pre>
                    </p>
                </div>
                <!-- Конец 4 -->

                <!-- Начало 5 -->
                <p class="text" style="font-size: 22px; margin-top: 40px;"><b><a name="EnumFields">EnumFields</a></b></p>
                <hr class="horizontal-line">
                <div class="code-section">
                    <p class="text">
                        <span class="keyword-type">string</span> EnumFields(<span class="keyword-arg">string</span> strTable);
                    </p>
                </div>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Позволяет перечислить все поля таблицы, указанной в аргументе функции. Функция возвращает строковый результат в формате <b><i>JSON</i></b>. 
                    <br>
                    Возвращаемый результат:
                    <ul style="margin-left: 5%;">
                        <li>В случае успеха возвращает строку в формате <b><i>JSON</i></b>, в которой при помощи библиотеки <b><i>Newtonsoft.JSON</i></b> можно спарсить поле <i>"Fields"</i>, тем 
                            самым получив список необходимых полей;
                        </li>
                        <li>В случае неудачи возвращает <span class="keyword-blue">null</span>.
                        <br><br>
                        Если функция вернула значение <span class="keyword-blue">null</span>, Вы не 
                        сможете проверить его при помощи свойства <b><i>.Length</i></b>, для этого Вы можете проверить результат возврата через оператор сравнения: 
                    <b><i>!= null</i></b> или метода <b><i>string.IsNullOrEmpty</i></b>.</li>
                    </ul>
                </p>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Аргументы:
                    <ol style="margin-left: 5%;">
                        <li ><b style="background-color: rgb(215, 215, 215);">[in] strTable</b> - Наименование таблицы из которой Вы хотите получить список полей.</li>
                        <br>
                        Вы можете воспользоваться библиотекой <b><i>Newtonsoft.JSON</i></b> для парсинга результата возврата функции <b><i>EnumTables</i></b> и запустить цикл, который 
                        будет перечислять все поля для <i>i-таблицы</i> в массиве.
                    </ol>
                </p>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример импорта
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 80%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
[<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
<span class="keyword-type">extern public static string</span> EnumFields(<span class="keyword-arg">string</span> strTable);
</pre>
                    </p>
                </div>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример кода
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 83.2%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
<span class="keyword-blue">using</span> System;
<span class="keyword-blue">using</span> System.Text;
<span class="keyword-blue">using</span> System.Linq;
<span class="keyword-blue">using</span> Newtonsoft.Json.Linq;
<span class="keyword-blue">using</span> System.Runtime.InteropServices;

<span class="keyword-blue">namespace</span> KabisAPITest
{
    <span class="keyword-blue">internal class</span> Program
    {
        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32u.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static <span class="keyword-arg">IntPtr</span></span> ScanForPass(<span class="keyword-arg">string</span> strAppName);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> PtrToStr(<span class="keyword-arg">IntPtr</span> intPtr);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> OpenDataBase(<span class="keyword-arg">string</span> strDataBase, <span class="keyword-arg">string</span> strPassword);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> EnumTables();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetTableCount();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> EnumFields(<span class="keyword-arg">string</span> strTable);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> CloseDataBase();

        <span class="keyword-blue">static void</span> Main(<span class="keyword-arg">string[]</span> args)
        {
            <span class="keyword-class">Console</span>.InputEncoding = Encoding.<span class="keyword-class">UTF8</span>;
            <span class="keyword-class">Console</span>.OutputEncoding = Encoding.<span class="keyword-class">UTF8</span>;

            <span class="keyword-blue">if</span> (OpenDataBase(<span class="keyword-arg">"C:\\KABIS\\Data\\Books.dbx"</span>, PtrToStr(ScanForPass(<span class="keyword-arg">"C:\\KABIS\\KABIS.EXE"</span>))))
            {
                <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"База данных была успешно открыта!"</span>);
                <span class="keyword-blue">string</span> strTables = EnumTables();

                <span class="keyword-blue">if</span> (!<span class="keyword-blue">string</span>.IsNullOrEmpty(strTables))
                {
                    <span class="keyword-type">JToken</span> jtTables = <span class="keyword-class">JObject</span>.Parse(strTables)[<span class="keyword-arg">"Tables"</span>];

                    <span class="keyword-type">for</span> (<span class="keyword-blue">int</span> a = 0; a < jtTables.Count(); a++)
                    {
                        <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"[+] Поля для таблицы \"{0}\":\n-------------------------"</span>, 
                            jtTables[a].ToString());
                        <span class="keyword-blue">string</span> strFields = EnumFields(jtTables[a].ToString());

                        <span class="keyword-blue">if</span> (!<span class="keyword-blue">string</span>.IsNullOrEmpty(strFields))
                        {
                            <span class="keyword-type">JToken</span> jtFields = <span class="keyword-class">JObject</span>.Parse(strFields)[<span class="keyword-arg">"Fields"</span>];

                            <span class="keyword-type">for</span> (<span class="keyword-blue">int</span> b = 0; b < jtFields.Count(); b++)
                                <span class="keyword-class">Console</span>.WriteLine((b + <span class="keyword-arg">": "</span> + jtFields[b]));
                        }

                        <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"-------------------------\n"</span>);
                    }

                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Все поля всех таблиц были перечислены!"</span>);
                }
                <span class="keyword-blue">else</span>
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Не удалось получить перечень таблиц из базы данных!"</span>);

                <span class="keyword-blue">if</span> (CloseDataBase())
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Соединение с базой данных было закрыто."</span>);
            }

            <span class="keyword-class">Console</span>.ReadKey();
        }
    }
}</pre>
                    </p>
                </div>
                <!-- Конец 5 -->

                <!-- Начало 6 -->
                <p class="text" style="font-size: 22px; margin-top: 40px;"><b><a name="GetFieldCount">GetFieldCount</a></b></p>
                <hr class="horizontal-line">
                <div class="code-section">
                    <p class="text">
                        <span class="keyword-type">int</span> GetFieldCount(<span class="keyword-arg">string</span> strTable);
                    </p>
                </div>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Возвращает число полей в таблице, указанной в аргументе функции. 
                    <br>
                    Возвращаемый результат:
                    <ul style="margin-left: 5%;">
                        <li>В случае успеха возвращает целое неотрицательное число, число полей в указанной таблице;
                            <br>Также, число полей таблицы Вы можете получить при помощи библиотеки <b><i>Newtonsoft.JSON</i></b>, просто вызвав функцию <b><i>EnumFields</i></b>, 
                            спарсив возвращаемый результат и подсчитав количество ячеек в массиве <i>"Fields"</i>.
                        </li>
                        <br>
                        <li>В случае неудачи возвращает <b>-1</b>.
                    </ul>
                </p>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Аргументы:
                    <ol style="margin-left: 5%;">
                        <li ><b style="background-color: rgb(215, 215, 215);">[in] strTable</b> - Наименование таблицы из которой Вы хотите получить количество полей.</li>
                    </ol>
                </p>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример импорта
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 80%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
[<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
<span class="keyword-type">extern public static int</span> GetFieldCount(<span class="keyword-arg">string</span> strTable);
</pre>
                    </p>
                </div>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример кода
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 83.2%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
<span class="keyword-blue">using</span> System;
<span class="keyword-blue">using</span> System.Text;
<span class="keyword-blue">using</span> System.Runtime.InteropServices;

<span class="keyword-blue">namespace</span> KabisAPITest
{
    <span class="keyword-blue">internal class</span> Program
    {
        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32u.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static <span class="keyword-arg">IntPtr</span></span> ScanForPass(<span class="keyword-arg">string</span> strAppName);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> PtrToStr(<span class="keyword-arg">IntPtr</span> intPtr);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> OpenDataBase(<span class="keyword-arg">string</span> strDataBase, <span class="keyword-arg">string</span> strPassword);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> EnumTables();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetTableCount();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> EnumFields(<span class="keyword-arg">string</span> strTable);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetFieldCount(<span class="keyword-arg">string</span> strTable);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> CloseDataBase();

        <span class="keyword-blue">static void</span> Main(<span class="keyword-arg">string[]</span> args)
        {
            <span class="keyword-class">Console</span>.InputEncoding = Encoding.<span class="keyword-class">UTF8</span>;
            <span class="keyword-class">Console</span>.OutputEncoding = Encoding.<span class="keyword-class">UTF8</span>;

            <span class="keyword-blue">if</span> (OpenDataBase(<span class="keyword-arg">"C:\\KABIS\\Data\\Books.dbx"</span>, PtrToStr(ScanForPass(<span class="keyword-arg">"C:\\KABIS\\KABIS.EXE"</span>))))
            {
                <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Кол-во поле в таблице \"Books\": {0}"</span>, GetFieldCount(<span class="keyword-arg">"Books"</span>));

                <span class="keyword-blue">if</span> (CloseDataBase())
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Соединение с базой данных было закрыто."</span>);
            }

            <span class="keyword-class">Console</span>.ReadKey();
        }
    }
}</pre>
                    </p>
                </div>
                <!-- Конец 6 -->

                <!-- Начало 7 -->
                <p class="text" style="font-size: 22px; margin-top: 40px;"><b><a name="SelectAllFrom">SelectAllFrom</a></b></p>
                <hr class="horizontal-line">
                <div class="code-section">
                    <p class="text">
                        <span class="keyword-type">string</span> SelectAllFrom(<span class="keyword-arg">string</span> strTable, <span class="keyword-arg">bool</span> bOutput);
                    </p>
                </div>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Извлекает все данные таблицы, указанной в аргументе, вместе с полями через запрос <i>"SELECT * FROM `%TableName%`;"</i>. 
                    <br>
                    Возвращаемый результат:
                    <ul style="margin-left: 5%;">
                        <li>В случае успеха возвращает текст, в котором содержатся все поля и их значения в указанной таблице;</li>
                        <li>В случае неудачи возвращает пустую строку <b>"" (string.Empty)</b>.
                    </ul>
                </p>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Аргументы:
                    <ol style="margin-left: 5%;">
                        <li ><b style="background-color: rgb(215, 215, 215);">[in] strTable</b> - Наименование таблицы из которой Вы хотите выгрузить все поля вместе с их значением;</li>
                        <li ><b style="background-color: rgb(215, 215, 215);">[in] bOutput</b> - Выводит в консоль текущую строку (текст) во время выполнения выгрузки. 
                        <br><br>
                        Это полезно в тех случаях, когда таблица содержит слишком много записей и их выгрузка может занять продолжительное время, то есть, Вы можете ожидать очень долго, пока функция вернёт Вам значение. Для того, чтобы убедиться, 
                        что записи выгружаются из базы данных, Вы можете в качестве аргумента указать значение <span class="keyword-blue">true</span>.</li>
                    </ol>
                </p>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример импорта
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 80%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
[<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
<span class="keyword-type">extern public static string</span> SelectAllFrom(<span class="keyword-arg">string</span> strTable, <span class="keyword-arg">bool</span> bOutput);
</pre>
                    </p>
                </div>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример кода
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 83.2%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
<span class="keyword-blue">using</span> System;
<span class="keyword-blue">using</span> System.Text;
<span class="keyword-blue">using</span> System.Runtime.InteropServices;

<span class="keyword-blue">namespace</span> KabisAPITest
{
    <span class="keyword-blue">internal class</span> Program
    {
        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32u.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static <span class="keyword-arg">IntPtr</span></span> ScanForPass(<span class="keyword-arg">string</span> strAppName);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> PtrToStr(<span class="keyword-arg">IntPtr</span> intPtr);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> OpenDataBase(<span class="keyword-arg">string</span> strDataBase, <span class="keyword-arg">string</span> strPassword);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> EnumTables();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetTableCount();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> EnumFields(<span class="keyword-arg">string</span> strTable);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetFieldCount(<span class="keyword-arg">string</span> strTable);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> SelectAllFrom(<span class="keyword-arg">string</span> strTable, <span class="keyword-arg">bool</span> bOutput);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> CloseDataBase();

        <span class="keyword-blue">static void</span> Main(<span class="keyword-arg">string[]</span> args)
        {
            <span class="keyword-class">Console</span>.InputEncoding = Encoding.<span class="keyword-class">UTF8</span>;
            <span class="keyword-class">Console</span>.OutputEncoding = Encoding.<span class="keyword-class">UTF8</span>;

            <span class="keyword-blue">if</span> (OpenDataBase(<span class="keyword-arg">"C:\\KABIS\\Data\\Books.dbx"</span>, PtrToStr(ScanForPass(<span class="keyword-arg">"C:\\KABIS\\KABIS.EXE"</span>))))
            {
                <span class="keyword-blue">string</span> strResult = SelectAllFrom(<span class="keyword-arg">"Librarians"</span>, <span class="keyword-blue">false</span>);
                <span class="keyword-class">Console</span>.WriteLine(strResult);

                <span class="keyword-blue">if</span> (CloseDataBase())
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Соединение с базой данных было закрыто."</span>);
            }

            <span class="keyword-class">Console</span>.ReadKey();
        }
    }
}</pre>
                    </p>
                </div>
                <!-- Конец 7 -->

                <!-- Начало 8 -->
                <p class="text" style="font-size: 22px; margin-top: 40px;"><b><a name="UnloadTable">UnloadTable</a></b></p>
                <hr class="horizontal-line">
                <div class="code-section">
                    <p class="text">
                        <span class="keyword-type">string</span> UnloadTable(<span class="keyword-arg">string</span> strTable, <span class="keyword-arg">string</span> strFile, <span class="keyword-arg">int</span> iType, <span class="keyword-arg">bool</span> bOutput);
                    </p>
                </div>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Позволяет выгрузить все записи таблицы вместе с полями в какой-либо файл с указанными разделителями. 
                    <br>
                    Возвращаемый результат:
                    <ul style="margin-left: 5%;">
                        <li>В случае успеха возвращает текст, в котором содержатся все поля и их значения в указанной таблице только с определёнными разделителями, указанным в третьем аргументе функции;</li>
                        <li>В случае неудачи возвращает пустую строку <b>"" (string.Empty)</b>.
                    </ul>
                </p>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Аргументы:
                    <ol style="margin-left: 5%;">
                        <li><b style="background-color: rgb(215, 215, 215);">[in] strTable</b> - Наименование таблицы из которой Вы хотите выгрузить все поля вместе с их значением;</li>
                        <li><b style="background-color: rgb(215, 215, 215);">[in] strFile</b> - Имя файла, в который Вы хотите сохранить выгруженные данные из таблицы;
                            <br><br>
                            В случае отсутствия аргумента (<span class="keyword-blue">null</span>) или передачи в него пустого значения <b>"" (string.Empty)</b> выгрузка данных таблицы произойдёт без сохранения их в указанный файл. 
                            В любом случае, результат возвращаемого значения функции <b><i>UnloadTable</i></b> Вы сможете записать в какой-либо файл самостоятельно, при помощи класса <b><i>File</i></b>, через один из имеющихся методов, к примеру <b><i>File.WriteAllText("MyTable.txt", "Какой-то текст или данные из таблицы.");</i></b>.
                            <br>
                            Для этого Вам нужно будет подключить пространство имён <b><i>"System.IO" (using System.IO;)</i></b>.
                        </li>
                        <br>
                        <li><b style="background-color: rgb(215, 215, 215);">[in] iType</b> - Номер разделителя при выгрузке столбцов. Библиотека поддерживает выгрузку со следующими разделителя: 
                            <br><br>
                            <ul type="disc">
                                <li><b>0</b> - Выгрузка без разделителя, то есть обычным списком, который прописан в алгоритме библиотеки;</li>
                                <li><b>1</b> - Разделителем будет являться символ "," (запятая);</li>
                                <li><b>2</b> - Разделителем будет являться символ ";" (точка с запятой);</li>
                                <li><b>3</b> - Разделителем будет являться символ ":" (двоеточие);</li>
                                <li><b>4</b> - Разделителем будет являться символ "\t" (знак табуляции).</li>
                            </ul>
                            <br>
                            Если в аргументе <b>iType</b> функции <b>UnloadTable</b> Вы укажите значение > 4 или < 0, то функция вернёт Вам пустой результат <b>"" (string.Empty)</b>.
                            <br>
                            <br>
                        </li>
                        <li><b style="background-color: rgb(215, 215, 215);">[in] bOutput</b> - Выводит в консоль текущую строку (текст) во время выполнения выгрузки.</li>
                        <br>
                        Это полезно в тех случаях, когда таблица содержит слишком много записей и их выгрузка может занять продолжительное время, то есть, Вы можете ожидать очень долго, пока функция вернёт Вам значение. Для того, чтобы убедиться, 
                        что записи выгружаются из базы данных, Вы можете в качестве аргумента указать значение <span class="keyword-blue">true</span>.</li>
                    </ol>
                </p>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример импорта
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 80%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
[<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
<span class="keyword-type">extern public static string</span> UnloadTable(<span class="keyword-arg">string</span> strTable, <span class="keyword-arg">string</span> strFile, <span class="keyword-arg">int</span> iType, <span class="keyword-arg">bool</span> bOutput);
</pre>
                    </p>
                </div>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример кода
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 83.2%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
<span class="keyword-blue">using</span> System;
<span class="keyword-blue">using</span> System.Text;
<span class="keyword-blue">using</span> System.Runtime.InteropServices;

<span class="keyword-blue">namespace</span> KabisAPITest
{
    <span class="keyword-blue">internal class</span> Program
    {
        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32u.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static <span class="keyword-arg">IntPtr</span></span> ScanForPass(<span class="keyword-arg">string</span> strAppName);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> PtrToStr(<span class="keyword-arg">IntPtr</span> intPtr);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> OpenDataBase(<span class="keyword-arg">string</span> strDataBase, <span class="keyword-arg">string</span> strPassword);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> EnumTables();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetTableCount();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> EnumFields(<span class="keyword-arg">string</span> strTable);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetFieldCount(<span class="keyword-arg">string</span> strTable);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> SelectAllFrom(<span class="keyword-arg">string</span> strTable, <span class="keyword-arg">bool</span> bOutput);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> UnloadTable(<span class="keyword-arg">string</span> strTable, <span class="keyword-arg">string</span> strFile, <span class="keyword-arg">int</span> iType, <span class="keyword-arg">bool</span> bOutput);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> CloseDataBase();

        <span class="keyword-blue">static void</span> Main(<span class="keyword-arg">string[]</span> args)
        {
            <span class="keyword-class">Console</span>.InputEncoding = Encoding.<span class="keyword-class">UTF8</span>;
            <span class="keyword-class">Console</span>.OutputEncoding = Encoding.<span class="keyword-class">UTF8</span>;

            <span class="keyword-blue">if</span> (OpenDataBase(<span class="keyword-arg">"C:\\KABIS\\Data\\Books.dbx"</span>, PtrToStr(ScanForPass(<span class="keyword-arg">"C:\\KABIS\\KABIS.EXE"</span>))))
            {
                <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"База данных была успешно открыта!"</span>);
                
                <span class="keyword-blue">if</span> (!<span class="keyword-blue">string</span>.IsNullOrEmpty(UnloadTable(<span class="keyword-arg">"Librarians"</span>, <span class="keyword-arg">"Users.txt"</span>, 1, <span class="keyword-blue">false</span>)))
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Данные таблицы были успешно выгружены в файл \"Users.txt\"."</span>);
                <span class="keyword-blue">else</span>
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Не удалось выгрузить данные таблицы."</span>);

                <span class="keyword-blue">if</span> (CloseDataBase())
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Соединение с базой данных было закрыто."</span>);
            }

            <span class="keyword-class">Console</span>.ReadKey();
        }
    }
}</pre>
                    </p>
                </div>
                <!-- Конец 8 -->

                <!-- Начало 9 -->
                <p class="text" style="font-size: 22px; margin-top: 40px;"><b><a name="GetTableRecords">GetTableRecords</a></b></p>
                <hr class="horizontal-line">
                <div class="code-section">
                    <p class="text">
                        <span class="keyword-type">int</span> GetTableRecords(<span class="keyword-arg">string</span> strTable);
                    </p>
                </div>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Получает количество записей в таблице, указанной в аргументе функции. Например, для получения количества книг во всех каталогах (для получения записей в определённом каталоге нужно делать кастомный запрос).
                    <br>
                    Возвращаемый результат:
                    <ul style="margin-left: 5%;">
                        <li>В случае успеха возвращает целое неотрицательное число, то есть количество записей в текущей таблице, указанной в аргументе функции;</li>
                        <li>В случае неудачи возвращает цифру <b>-1</b>.</li>
                    </ul>
                </p>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Аргументы:
                    <ol style="margin-left: 5%;">
                        <li><b style="background-color: rgb(215, 215, 215);">[in] strTable</b> - Наименование таблицы в которой Вы хотите узнать количество записей.</li>
                    </ol>
                </p>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример импорта
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 80%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
[<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
<span class="keyword-type">extern public static int</span> GetTableRecords(<span class="keyword-arg">string</span> strTable);
</pre>
                    </p>
                </div>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример кода
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 83.2%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
<span class="keyword-blue">using</span> System;
<span class="keyword-blue">using</span> System.Text;
<span class="keyword-blue">using</span> System.Runtime.InteropServices;

<span class="keyword-blue">namespace</span> KabisAPITest
{
    <span class="keyword-blue">internal class</span> Program
    {
        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32u.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static <span class="keyword-arg">IntPtr</span></span> ScanForPass(<span class="keyword-arg">string</span> strAppName);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> PtrToStr(<span class="keyword-arg">IntPtr</span> intPtr);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> OpenDataBase(<span class="keyword-arg">string</span> strDataBase, <span class="keyword-arg">string</span> strPassword);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> EnumTables();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetTableCount();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> EnumFields(<span class="keyword-arg">string</span> strTable);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetFieldCount(<span class="keyword-arg">string</span> strTable);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> SelectAllFrom(<span class="keyword-arg">string</span> strTable, <span class="keyword-arg">bool</span> bOutput);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> UnloadTable(<span class="keyword-arg">string</span> strTable, <span class="keyword-arg">string</span> strFile, <span class="keyword-arg">int</span> iType, <span class="keyword-arg">bool</span> bOutput);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetTableRecords(<span class="keyword-arg">string</span> strTable);
        
        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> CloseDataBase();

        <span class="keyword-blue">static void</span> Main(<span class="keyword-arg">string[]</span> args)
        {
            <span class="keyword-class">Console</span>.InputEncoding = Encoding.<span class="keyword-class">UTF8</span>;
            <span class="keyword-class">Console</span>.OutputEncoding = Encoding.<span class="keyword-class">UTF8</span>;

            <span class="keyword-blue">if</span> (OpenDataBase(<span class="keyword-arg">"C:\\KABIS\\Data\\Books.dbx"</span>, PtrToStr(ScanForPass(<span class="keyword-arg">"C:\\KABIS\\KABIS.EXE"</span>))))
            {
                <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"База данных была успешно открыта!"</span>);
                <span class="keyword-blue">int</span> iRecords = GetTableRecords(<span class="keyword-arg">"Books"</span>);

                <span class="keyword-blue">if</span> (iRecords != -1)
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Кол-во книг в библиотечном фонде: {0}"</span>, iRecords);
                <span class="keyword-blue">else</span>
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Не удалось получить кол-во записей для текущей таблицы."</span>);

                <span class="keyword-blue">if</span> (CloseDataBase())
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Соединение с базой данных было закрыто."</span>);
            }

            <span class="keyword-class">Console</span>.ReadKey();
        }
    }
}</pre>
                    </p>
                </div>
                <!-- Конец 9 -->

                <!-- Начало 10 -->
                <p class="text" style="font-size: 22px; margin-top: 40px;"><b><a name="CloseDataBase">CloseDataBase</a></b></p>
                <hr class="horizontal-line">
                <div class="code-section">
                    <p class="text">
                        <span class="keyword-type">bool</span> CloseDataBase();
                    </p>
                </div>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Закрывает соединение с базой данных. Должна вызываться после завершения работы с базой данных.
                    <br>
                    Возвращаемый результат:
                    <ul style="margin-left: 5%;">
                        <li>В случае успеха возвращает значение <span class="keyword-blue">true</span>;</li>
                        <li>В случае неудачи возвращает значение <span class="keyword-blue">false</span>.
                    </ul>
                </p>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Аргументы: <b style="background-color: rgb(215, 215, 215);">Функция не принимает аргументов.</b>
                </p>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример импорта
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 80%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
[<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
<span class="keyword-type">extern public static bool</span> CloseDataBase();
</pre>
                    </p>
                </div>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример кода
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 83.2%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
<span class="keyword-blue">using</span> System;
<span class="keyword-blue">using</span> System.Text;
<span class="keyword-blue">using</span> System.Runtime.InteropServices;

<span class="keyword-blue">namespace</span> KabisAPITest
{
    <span class="keyword-blue">internal class</span> Program
    {
        <span class="keyword-comment">/* Тут находятся все функции экспорта, которые содержит библиотека kapi32.dll и kapi32u.dll */</span>

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32u.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static <span class="keyword-arg">IntPtr</span></span> ScanForPass(<span class="keyword-arg">string</span> strAppName);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> PtrToStr(<span class="keyword-arg">IntPtr</span> intPtr);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> OpenDataBase(<span class="keyword-arg">string</span> strDataBase, <span class="keyword-arg">string</span> strPassword);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> EnumTables();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetTableCount();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> EnumFields(<span class="keyword-arg">string</span> strTable);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetFieldCount(<span class="keyword-arg">string</span> strTable);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> SelectAllFrom(<span class="keyword-arg">string</span> strTable, <span class="keyword-arg">bool</span> bOutput);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> UnloadTable(<span class="keyword-arg">string</span> strTable, <span class="keyword-arg">string</span> strFile, <span class="keyword-arg">int</span> iType, <span class="keyword-arg">bool</span> bOutput);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetTableRecords(<span class="keyword-arg">string</span> strTable);
        
        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> CloseDataBase();

        <span class="keyword-blue">static void</span> Main(<span class="keyword-arg">string[]</span> args)
        {
            <span class="keyword-class">Console</span>.InputEncoding = Encoding.<span class="keyword-class">UTF8</span>;
            <span class="keyword-class">Console</span>.OutputEncoding = Encoding.<span class="keyword-class">UTF8</span>;

            <span class="keyword-blue">if</span> (OpenDataBase(<span class="keyword-arg">"C:\\KABIS\\Data\\Books.dbx"</span>, PtrToStr(ScanForPass(<span class="keyword-arg">"C:\\KABIS\\KABIS.EXE"</span>))))
            {
                <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"База данных была успешно открыта!"</span>);

                <span class="keyword-comment">//Здесь можно что-то выполнить перед закрытием базы данных...</span>

                <span class="keyword-blue">if</span> (CloseDataBase())
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Соединение с базой данных было закрыто."</span>);
            }

            <span class="keyword-class">Console</span>.ReadKey();
        }
    }
}</pre>
                    </p>
                </div>
                <!-- Конец 11 -->

                <hr class="horizontal-line-bold">
                <p class="text" style="font-size: 32px;"><a name="kapi32u.dll">[+] Работа с kapi32u.dll</a></p>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">Модуль (библиотека) содержит в себе всего лишь
                    одну экспортируемую функцию. Которая выполняет своё главное действие только один раз. Более подробнее написано в описании к функции.
                </p>

                <!-- Начало 10 -->
                <p class="text" style="font-size: 22px; margin-top: 40px;"><b><a name="ScanForPass">ScanForPass</a></b></p>
                <hr class="horizontal-line">
                <div class="code-section">
                    <p class="text">
                        <span class="keyword-type">IntPtr</span> ScanForPass(<span class="keyword-arg">string</span> strAppName);
                    </p>
                </div>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Извлекает из памяти процесса (<b>программы</b>) пароль для базы данных.
                    <br><br>
                    Так как данные о пароле не хранятся в реестре или в файловой системе компьютера, Вам необходимо будет вызывать эту функцию и результат её
                    выполнения передавать во второй аргумент функции <b><i>OpenDataBase</i></b> для корректного установления соединения с базой данных.
                    <br>
                    Возвращаемый результат:
                    <ul style="margin-left: 5%;">
                        <li>В случае успеха возвращает указатель на массив символов с паролем от базы данных, который затем 
                            необходимо будет преобразовать в строку при помощи функции <b>PtrToStr</b>;
                        </li>
                        <li>В случае неудачи возвращает пустую строку <b>""</b>.
                    </ul>
                </p>
                <p class="text" style="font-size: 18px; margin-left: 5%; margin-top: 15px;">
                    Аргументы:
                    <ol style="margin-left: 5%;">
                        <li><b style="background-color: rgb(215, 215, 215);">[in] strAppName</b> - Путь до Вашего приложения KABIS.
                            <br><br>
                            Для того, чтобы функция могла получить пароль от базы данных, ей необходимо запустить библиотечную программу для того, чтобы в её памяти 
                            получить пароль. 
                            <br><br>
                            <big><b>НО БУДЬТЕ ВНИМАТЕЛЬНЫ!</b></big>
                            <br>
                            Перед вызовом этой функции рекомендуется закрыть все экземпляры программы КАБИС, чтобы 
                            не потерять сохранённые в ней данные, иначе функция сделает это принудительно, так как ей необходимо запустить программу и получить 
                            правильный экземпляр приложения для того, чтобы корректно извлечь из него пароль для базы данных.
                            <br><br>
                            <big><b>ДОПОЛНИТЕЛЬНО:</b></big>
                            <br>
                            Также, после первого получения пароля от базы данных, функция создаёт раздел в реестре системы по следующему пути: 
                            <b><i>HKEY_CURRENT_USER\SOFTWARE\kapi32</i></b> с некоторыми ключами, одним из которых является ключ <b><i>DBPassword</i></b>. 
                            При следующем вызове данной функции она уже будет проверять реестр на наличие данного ключа, чтобы лишний раз не запускать библиотечное 
                            приложение.
                            <br>
                            <br>
                            В случае, если Вы удалите этот раздел или данный ключ, функция <b>ScanForPass</b> вновь запустит приложение для того, чтобы извлечь из его 
                            памяти пароль.
                            <br>
                            <br>
                            Также, Вы можете присвоить результат функции какой-то строковой переменной и вывести её в консоль, а после, передавать эту строку в качестве второго аргумента 
                            функции <b>OpenDataBase</b> для того, чтобы не использовать вызов функции <b>ScanForPass</b>.
                        </li>
                    </ol>
                </p>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример импорта
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 80%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
[<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32u.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
<span class="keyword-type">extern public static <span class="keyword-arg">IntPtr</span></span> ScanForPass(<span class="keyword-arg">string</span> strAppName);
</pre>
                    </p>
                </div>
                <div class="code-section cancopy" style="background-color: rgb(215, 215, 215);">
                    <p style="margin-top: 0px; margin-left: 0px; padding-left: 10px; padding-top: 5px; background-color: rgb(125, 125, 125); color: white; display: flex; height: 23px;">C# - Пример кода
                        <!-- Trash -->
                        <input type="button" class="btn-copy" style="width: 23px; height: 23px; padding: 0; margin-left: 83.2%; margin-top: -2px;" value="🗐" title="Копировать">
                    </p> 
                    <p class="text">
                        <pre style="margin-left: 3%; margin-right: 3%;">
<span class="keyword-blue">using</span> System;
<span class="keyword-blue">using</span> System.Text;
<span class="keyword-blue">using</span> System.Runtime.InteropServices;

<span class="keyword-blue">namespace</span> KabisAPITest
{
    <span class="keyword-blue">internal class</span> Program
    {
        <span class="keyword-comment">/* Тут находятся все функции экспорта, которые содержит библиотека kapi32.dll и kapi32u.dll */</span>

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32u.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static <span class="keyword-arg">IntPtr</span></span> ScanForPass(<span class="keyword-arg">string</span> strAppName);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> PtrToStr(<span class="keyword-arg">IntPtr</span> intPtr);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> OpenDataBase(<span class="keyword-arg">string</span> strDataBase, <span class="keyword-arg">string</span> strPassword);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> EnumTables();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetTableCount();

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> EnumFields(<span class="keyword-arg">string</span> strTable);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetFieldCount(<span class="keyword-arg">string</span> strTable);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> SelectAllFrom(<span class="keyword-arg">string</span> strTable, <span class="keyword-arg">bool</span> bOutput);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static string</span> UnloadTable(<span class="keyword-arg">string</span> strTable, <span class="keyword-arg">string</span> strFile, <span class="keyword-arg">int</span> iType, <span class="keyword-arg">bool</span> bOutput);

        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static int</span> GetTableRecords(<span class="keyword-arg">string</span> strTable);
        
        [<span class="keyword-class">DllImport</span>(<span class="keyword-arg">"kapi32.dll"</span>, CallingConvention = <span class="keyword-class">CallingConvention</span>.StdCall)]
        <span class="keyword-type">extern public static bool</span> CloseDataBase();

        <span class="keyword-blue">static void</span> Main(<span class="keyword-arg">string[]</span> args)
        {
            <span class="keyword-class">Console</span>.InputEncoding = Encoding.<span class="keyword-class">UTF8</span>;
            <span class="keyword-class">Console</span>.OutputEncoding = Encoding.<span class="keyword-class">UTF8</span>;

            <span class="keyword-blue">string</span> strDBPassword = PtrToStr(ScanForPass(<span class="keyword-arg">"C:\\KABIS\\KABIS.EXE"</span>));
            <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Пароль от базы данных: {0}"</span>, strDBPassword);

            <span class="keyword-blue">if</span> (OpenDataBase(<span class="keyword-arg">"C:\\KABIS\\Data\\Books.dbx"</span>, strDBPassword))
            {
                <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"База данных была успешно открыта!"</span>);

                <span class="keyword-comment">//Здесь можно что-то выполнить перед закрытием базы данных...</span>

                <span class="keyword-blue">if</span> (CloseDataBase())
                    <span class="keyword-class">Console</span>.WriteLine(<span class="keyword-arg">"Соединение с базой данных было закрыто."</span>);
            }

            <span class="keyword-class">Console</span>.ReadKey();
        }
    }
}</pre>
                    </p>
                </div>
                <!-- Конец 11 -->
                 
                <div style="margin-bottom: 40px;"></div>
                <hr class="horizontal-line">
                <div style="display: flex; flex-wrap: wrap; justify-content: center; margin-top: 25px;">
                    <input type="button" class="btn" id="top" style="width: 30%; height: 40px; margin-bottom: 7px; margin-left: 5px;" value="В начало">
                    <input type="button" class="btn" id="github" style="width: 30%; height: 40px; margin-bottom: 25px; margin-left: 15px" value="GitHub">
                    <input type="button" class="btn" id="discord" style="width: 30%; height: 40px; margin-bottom: 25px; margin-left: 15px" value="Discord">
                </div>
            </div>

            <div class="block">
                <p class="text-header"><a name="Conclusion"><b>Заключение</b></a></p>
                <hr class="horizontal-line-bold">
                <p class="text" style="font-size: 18px; margin-left: 5%;">
                    Вы можете использовать все функции экспорта так, как захотите, всё зависит только от Вашего воображения. Теперь, при помощи 
                    данного инструмента у Вас появится возможность интеграции библиотечной системы KABIS с другими корпоративными системами, по крайней мере 
                    у меня.
                    <br><br>
                    Также, в случае обнаружения проблем библиотеки или проблем при работе с ней, Вы можете задать мне любые вопросы по этому поводу в <a href="https://discordapp.com/users/428279123526549506">Discord</a>.
                    <br><br>Ну, вроде бы ничего не забыл описать. В любом случае, документация будет обновляться параллельно с добавлением нового функционала в 
                    библиотеку (модуль).
                <div style="margin-bottom: 40px;"></div>
            </div>

        </div>
        <script src="script.js"></script>
    </body>
</html>